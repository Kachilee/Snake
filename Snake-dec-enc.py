import base64
exec(base64.b64decode("IyEvdXNyL2Jpbi9weXRob24zCiMtKi1jb2Rpbmc6dXRmLTgtKi0KIyBNYWRlIFdpdGgg4p2k77iPIEJ5IEthY2hpCiMgVGhhbmtzIFRvIE1lCiMgVGhhbmtzIFRvIEFsbCBNeSBGcmllbmRzCiMgUGxlYXNlIERvbid0IFJlY29kZSwgVGhhbmtzLgoKaW1wb3J0IHJlcXVlc3RzLG1lY2hhbml6ZSxiczQsc3lzLG9zLHN1YnByb2Nlc3MsdXVpZCxyYW5kb20sdGltZSxyZSxiYXNlNjQsY29uY3VycmVudC5mdXR1cmVzLGpzb24KZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKZnJvbSBjb25jdXJyZW50LmZ1dHVyZXMgaW1wb3J0IFRocmVhZFBvb2xFeGVjdXRvciBhcyBUaHJlYWRQb29sCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGUKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKY3VycmVudCA9IGRhdGV0aW1lLm5vdygpCgpwID0gIlx4MWJbMDszN20iICMgcHV0aWgKbSA9ICJceDFiWzA7MzFtIiAjIG1lcmFoCmggPSAiXHgxYlswOzMybSIgIyBoaWphdQprID0gIlx4MWJbMDszM20iICMga3VuaW5nCmIgPSAiXHgxYlswOzM0bSIgIyBiaXJ1CnUgPSAiXHgxYlswOzM1bSIgIyB1bmd1Cm8gPSAiXHgxYlswOzM2bSIgIyBiaXJ1IG11ZGEKCmlmICgibGludXgiIGluIHN5cy5wbGF0Zm9ybS5sb3dlcigpKToKCiAgICAgICAgTiA9ICJcMDMzWzBtIgogICAgICAgIEcgPSAiXDAzM1sxOzkybSIKICAgICAgICBPID0gIlwwMzNbMTs5N20iCiAgICAgICAgUiA9ICJcMDMzWzE7OTFtIgplbHNlOgoKICAgICAgICBOID0gIiIKICAgICAgICBHID0gIiIKICAgICAgICBPID0gIiIKICAgICAgICBSID0gIiIKCiMjIyBIRUFERVJTICMjIwoKZGVmIGJhbm5lcigpOgogICAgcHJpbnQoIiIiICAgClwwMzNbMDszMW0uIyMuLi4uIyMuLi4uIyMjLi4uLi4jIyMjIyMuLiMjLi4uLi4jIy4jIyMjClwwMzNbMDszNW0uIyMuLi4jIy4uLi4jIy4jIy4uLiMjLi4uLiMjLiMjLi4uLi4jIy4uIyMuClwwMzNbMDszNm0uIyMuLiMjLi4uLiMjLi4uIyMuLiMjLi4uLi4uLiMjLi4uLi4jIy4uIyMuClwwMzNbMDszNG0uIyMjIyMuLi4uIyMuLi4uLiMjLiMjLi4uLi4uLiMjIyMjIyMjIy4uIyMuClwwMzNbMDszN20uIyMuLiMjLi4uIyMjIyMjIyMjLiMjLi4uLi4uLiMjLi4uLi4jIy4uIyMuClwwMzNbMDszM20uIyMuLi4jIy4uIyMuLi4uLiMjLiMjLi4uLiMjLiMjLi4uLi4jIy4uIyMuClwwMzNbMDszMm0uIyMuLi4uIyMuIyMuLi4uLiMjLi4jIyMjIyMuLiMjLi4uLi4jIy4jIyMjClwwMzNbMzc7MW1bXDAzM1s0MTsxbSBGQUNFQk9PSyBBQ0NPVU5UIENMT05JTkcgXDAzM1swMDsxbVwwMzNbMzc7MW0gXVxuClwwMzNbMTszNzs0MG3ilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJAKXDAzM1sxOzM3OzQwbeKUgiDCriBTY3JpcHQgQnkgS2FjaGkgwq4gfApcMDMzWzE7Mzc7NDBt4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYClwwMzNbMzc7MW1bXDAzM1s0MTsxbSBJRiBZT1UgV0FOIE1BS0UgQU0gRk9SIExJRkUgQkUgSFVNQkxFIFwwMzNbMDA7MW1cMDMzWzM3OzFtIF1cbgpcMDMzWzMyOzFtVmVyc2lvblwwMzNbMzc7MW06XDAzM1szMzsxbTEuMCIiIikKCmhvc3Q9Imh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbSIKaXBzPU5vbmUKdHJ5OgoJYj1yZXF1ZXN0cy5nZXQoImh0dHA6Ly9pcC1hcGkuY29tL2pzb24vIikuanNvbigpWyJxdWVyeSJdCglpcHM9cmVxdWVzdHMuZ2V0KCJodHRwOi8vaXAtYXBpLmNvbS9qc29uLyIrYixoZWFkZXJzPXsiUmVmZXJlciI6Imh0dHA6Ly9pcC1hcGkuY29tLyIsIkNvbnRlbnQtVHlwZSI6ImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLCJVc2VyLUFnZW50IjoiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IG1vdG8gZTYgcGxheSBCdWlsZC9QT0EyOS41NTAtMTMyOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzg1LjAuNDE4My4xMDEgTW9iaWxlIFNhZmFyaS81MzcuMzYgW0ZCX0lBQi9GQjRBO0ZCQVYvMzA1LjEuMC40MC4xMjA7XSJ9KS5qc29uKClbImNvdW50cnkiXS5sb3dlcigpCmV4Y2VwdDoKCWlwcz1Ob25lCgpvayA9IFtdCmNwID0gW10KdHRsID1bXQoKZHVyYXNpID0gc3RyKGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlZC0lbS0lWSIpKQp0YWh1biA9IGN1cnJlbnQueWVhcgpidWxhbiA9IGN1cnJlbnQubW9udGgKaGFyaSA9IGN1cnJlbnQuZGF5CgpkZWYgamFsYW4oeik6Cglmb3IgZSBpbiB6ICsgIlxuIjoKCQlzeXMuc3Rkb3V0LndyaXRlKGUpCgkJc3lzLnN0ZG91dC5mbHVzaCgpCgkJdGltZS5zbGVlcCgwLjAzKQoKZGVmIGNsZWFyKCk6CglpZiAiIGxpbnV4IiBpbiBzeXMucGxhdGZvcm0ubG93ZXIoKToKCQlvcy5zeXN0ZW0oImNsZWFyIikKCWVsaWYgIndpbiIgaW4gc3lzLnBsYXRmb3JtLmxvd2VyKCk6CgkJb3Muc3lzdGVtKCJjbHMiKQoJZWxzZTpvcy5zeXN0ZW0oImNsZWFyIikKICAgIApkZWYgbGFuZyhjb29raWVzKToKCWY9RmFsc2UKCXJyPWJzNC5CZWF1dGlmdWxTb3VwKHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xhbmd1YWdlLnBocCIsaGVhZGVycz1oZGNvaygpLGNvb2tpZXM9Y29va2llcykudGV4dCwiaHRtbC5wYXJzZXIiKQoJZm9yIGkgaW4gcnIuZmluZF9hbGwoImEiLGhyZWY9VHJ1ZSk6CgkJaWYgImlkX0lEIiBpbiBpLmdldCgiaHJlZiIpOgoJCQlyZXF1ZXN0cy5nZXQoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iK2kuZ2V0KCJocmVmIiksY29va2llcz1jb29raWVzLGhlYWRlcnM9aGRjb2soKSkKCQkJYj1yZXF1ZXN0cy5nZXQoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9wcm9maWxlLnBocCIsaGVhZGVycz1oZGNvaygpLGNvb2tpZXM9Y29va2llcykudGV4dAkKCQkJaWYgImFwYSB5YW5nIGFuZGEgcGlraXJrYW4gc2VrYXJhbmciIGluIGIubG93ZXIoKToKCQkJCWY9VHJ1ZQoJaWYgZj09VHJ1ZToKCQlyZXR1cm4gVHJ1ZQoJZWxzZToKCQlleGl0KCJbIV0gV3JvbmcgQ29va2llcyIpCgpkZWYgYmFzZWNvb2tpZSgpOgoJaWYgb3MucGF0aC5leGlzdHMoIi5jb2siKToKCQlpZiBvcy5wYXRoLmdldHNpemUoIi5jb2siKSAhPTA6CgkJCXJldHVybiBnZXRzX2RpY3RfY29va2llcyhvcGVuKCcuY29rJykucmVhZCgpLnN0cmlwKCkpCgkJZWxzZTpsb2dzKCkKCWVsc2U6bG9ncygpCgpkZWYgaGRjb2soKToKCWdsb2JhbCBob3N0Cglob3N0cz1ob3N0CglyPXsib3JpZ2luIjogaG9zdHMsICJhY2NlcHQtbGFuZ3VhZ2UiOiAiaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciLCAiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgOTsgbW90byBlNiBwbGF5IEJ1aWxkL1BPQTI5LjU1MC0xMzI7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvODUuMC40MTgzLjEwMSBNb2JpbGUgU2FmYXJpLzUzNy4zNiBbRkJfSUFCL0ZCNEE7RkJBVi8zMDUuMS4wLjQwLjEyMDtdIiwgIkhvc3QiOiAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCI6Ly8oLio/KSQiLGhvc3RzKSksICJyZWZlcmVyIjogaG9zdHMrIi9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgiLCAiY2FjaGUtY29udHJvbCI6ICJtYXgtYWdlPTAiLCAidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6ICIxIiwgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifQoJcmV0dXJuIHIKCmRlZiBnZXRzX2Nvb2tpZXMoY29va2llcyk6CglyZXN1bHQ9W10KCWZvciBpIGluIGVudW1lcmF0ZShjb29raWVzLmtleXMoKSk6CgkJaWYgaVswXT09bGVuKGxpc3QoY29va2llcy5rZXlzKCkpKS0xOnJlc3VsdC5hcHBlbmQoaVsxXSsiPSIrY29va2llc1tpWzFdXSkKCQllbHNlOnJlc3VsdC5hcHBlbmQoaVsxXSsiPSIrY29va2llc1tpWzFdXSsiOyAiKQoJcmV0dXJuICIiLmpvaW4ocmVzdWx0KQoKZGVmIGdldHNfZGljdF9jb29raWVzKGNvb2tpZXMpOgoJcmVzdWx0PXt9Cgl0cnk6CgkJZm9yIGkgaW4gY29va2llcy5zcGxpdCgiOyIpOgoJCQlyZXN1bHQudXBkYXRlKHtpLnNwbGl0KCI9IilbMF06aS5zcGxpdCgiPSIpWzFdfSkKCQlyZXR1cm4gcmVzdWx0CglleGNlcHQ6CgkJZm9yIGkgaW4gY29va2llcy5zcGxpdCgiOyAiKToKCQkJcmVzdWx0LnVwZGF0ZSh7aS5zcGxpdCgiPSIpWzBdOmkuc3BsaXQoIj0iKVsxXX0pCgkJcmV0dXJuIHJlc3VsdAoKIyMjIExPR0lOIE1FVEhPREUgIyMjCgpkZWYgbG9ncygpOgogIG9zLnN5c3RlbSgiY2xlYXIiKQogIGJhbm5lcigpCiAgcHJpbnQoKGsrIlxuWyIrcCsiMSIraysiXSIrcCsiIExvZ2luIFdpdGggVG9rZW4iKSkKICBwcmludCgoaysiWyIrcCsiMiIraysiXSIrcCsiIExvZ2luIFdpdGggQ29va2llcyIpKQogIHByaW50KChrKyJbIitwKyIwIitrKyJdIitwKyIgRXhpdCIpKQogIHNlaz1pbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENob29zZSA6ICIpCiAgaWYgc2VrPT0iIjoKICAgIHByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBGaWxsIEluIFRoZSBDb3JyZWN0IikpCiAgICBsb2dzKCkKICBlbGlmIHNlaz09IjEiOgogICAgbG9nX3Rva2VuKCkKICBlbGlmIHNlaz09IjIiOgogICAgZ2VuKCkKICBlbGlmIHNlaz09IjAiOgogICAgZXhpdCgpCiAgZWxzZToKICAgIHByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBGaWxsIEluIFRoZSBDb3JyZWN0IikpCiAgICBsb2dzKCkKCmRlZiBsb2dfdG9rZW4oKToKICAgIG9zLnN5c3RlbSgiY2xlYXIiKQogICAgYmFubmVyKCkKICAgIHRva2V0ID0gaW5wdXQoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBUb2tlbiA6ICIpCiAgICB0cnk6CiAgICAgICAgb3R3ID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49IiArIHRva2V0KQogICAgICAgIGEgPSBqc29uLmxvYWRzKG90dy50ZXh0KQogICAgICAgIG5hbWEgPSBhWyJuYW1lIl0KICAgICAgICB6ZWRkID0gb3BlbigibG9naW4udHh0IiwgInciKQogICAgICAgIHplZGQud3JpdGUodG9rZXQpCiAgICAgICAgemVkZC5jbG9zZSgpCiAgICAgICAgcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgTG9naW4gU3VjY2Vzc2Z1bCIpKQogICAgICAgIGJvdF9mb2xsb3coKQogICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgVG9rZW4gSW52YWxpZCIpKQogICAgICAgIG9zLnN5c3RlbSgiY2xlYXIiKQogICAgICAgIGxvZ3MoKQoKZGVmIGdlbigpOgogICAgICAgIG9zLnN5c3RlbSgiY2xlYXIiKQogICAgICAgIGJhbm5lcigpCiAgICAgICAgY29va2llID0gaW5wdXQoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDb29raWVzIDogIikKICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBkYXRhID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL20uZmFjZWJvb2suY29tL2NvbXBvc2VyL29jZWxvdC9hc3luY19sb2FkZXIvP3B1Ymxpc2hlcj1mZWVkI189XyIsIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAidXNlci1hZ2VudCIgICAgICAgICAgICAgICAgOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDExOyBMTS1HOTAwKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTUuMC40NjM4Ljc0IE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwgIyBKYW5nYW4gRGkgR2FudGkgRWEgQW5qaW5rLgogICAgICAgICAgICAgICAgInJlZmVyZXIiICAgICAgICAgICAgICAgICAgIDogImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIiwKICAgICAgICAgICAgICAgICJob3N0IiAgICAgICAgICAgICAgICAgICAgICA6ICJtLmZhY2Vib29rLmNvbSIsCiAgICAgICAgICAgICAgICAib3JpZ2luIiAgICAgICAgICAgICAgICAgICAgOiAiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbSIsCiAgICAgICAgICAgICAgICAidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyIgOiAiMSIsCiAgICAgICAgICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIiAgICAgICAgICAgOiAiaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciLAogICAgICAgICAgICAgICAgImNhY2hlLWNvbnRyb2wiICAgICAgICAgICAgIDogIm1heC1hZ2U9MCIsCiAgICAgICAgICAgICAgICAiYWNjZXB0IiAgICAgICAgICAgICAgICAgICAgOiAidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsCiAgICAgICAgICAgICAgICAiY29udGVudC10eXBlIiAgICAgICAgICAgICAgOiAidGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04IgogICAgICAgICAgICAgICAgfSwgY29va2llcyA9IHsKICAgICAgICAgICAgICAgICJjb29raWUiICAgICAgICAgICAgICAgICAgICA6IGNvb2tpZQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIGZpbmRfdG9rZW4gPSByZS5zZWFyY2goIihFQUFBXHcrKSIsIGRhdGEudGV4dCkKICAgICAgICAgICAgICAgIGhhc2lsICAgID0gIlxuKiBGYWlsIDogbWF5YmUgeW91ciBjb29raWUgaW52YWxpZCAhISIgaWYgKGZpbmRfdG9rZW4gaXMgTm9uZSkgZWxzZSAiXG4qIFlvdXIgZmIgYWNjZXNzIHRva2VuIDogIiArIGZpbmRfdG9rZW4uZ3JvdXAoMSkKICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6CiAgICAgICAgICAgICAgICBwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiIE5vIENvbm5lY3Rpb24iKSkKICAgICAgICBjb29raWUgPSBvcGVuKCJsb2dpbi50eHQiLCAidyIpCiAgICAgICAgY29va2llLndyaXRlKGZpbmRfdG9rZW4uZ3JvdXAoMSkpCiAgICAgICAgY29va2llLmNsb3NlKCkKICAgICAgICBwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBMb2dpbiBTdWNjZXNzZnVsIikpCiAgICAgICAgYm90X2ZvbGxvdygpCgojIyMgQk9UIEZPTExPVyAjIyMgSmFuZ2FuIERpZ2FudGkgQW5qaW5nICEhIQoKZGVmIGJvdF9mb2xsb3coKToKCXRyeToKCQl0b2tldD1vcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpCglleGNlcHQgSU9FcnJvcjoKCQlwcmludCgoaysiXG5bIitwKyIhIitrKyJdIitwKyIgVG9rZW4gSW52YWxpZCIpKQoJCWxvZ3MoKQoJa29tID0gKCIg4p2k77iP4p2k77iP4p2k77iP4p2k77iP4p2k77iPIikKCXJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzEwMDA2MTk2ODU0Mzk3Ni9zdWJzY3JpYmVycz9hY2Nlc3NfdG9rZW49JyArIHRva2V0KSAjT2tvcm8gT255ZWRpa2FjaGkgUHJvc3BlcgoJcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMTAwMDA0NDEyNTI2MzA5L3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0nICsgdG9rZXQpICNDb3JuZWxpdXMgQ2hpbmVkdW0gU3VuZGF5CglyZXF1ZXN0cy5wb3N0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8xOTAxNjkzODMwNTg2NzkvY29tbWVudHMvP21lc3NhZ2U9JyArdG9rZXQrICcmYWNjZXNzX3Rva2VuPScgKyB0b2tldCkKCXJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzE4NzQ3NDEzMzYwMTYyNjYvY29tbWVudHMvP21lc3NhZ2U9JyAra29tKyAnJmFjY2Vzc190b2tlbj0nICsgdG9rZXQpCgltZW51KCkKCiMjIyBNQUlOIE1FTlUgIyMjCgpkZWYgbWVudSgpOgogICAgdHJ5OgogICAgICAgIHRva2V0ID0gb3BlbigibG9naW4udHh0IiwiciIpLnJlYWQoKQogICAgICAgIG90dyA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWUvP2FjY2Vzc190b2tlbj0iK3Rva2V0KQogICAgICAgIGEgPSBqc29uLmxvYWRzKG90dy50ZXh0KQogICAgICAgIG5hbWEgPSBhWyJuYW1lIl0KICAgICAgICBpZCA9IGFbImlkIl0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRXJyb3IgOiAlcyIlZSkpCiAgICAgICAgbG9ncygpCiAgICBpcCA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9hcGkuaXBpZnkub3JnIikudGV4dAogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBiYW5uZXIoKQogICAgcHJpbnQoKGsrIlxuWyAiK3ArIldlbGNvbWUgIithWyJuYW1lIl0raysiIF0iK3ApKQogICAgcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgWW91ciBJRCA6ICIraWQpKQogICAgcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFlvdXIgSVAgOiAiK2lwKSkKICAgIHByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBTdGF0dXMgIDogIitrKyJJbiBEZXZlbG9wbWVudCIrcCkpCiAgICBwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgSm9pbmVkICA6ICIrZHVyYXNpKSkKICAgIHByaW50KChrKyJcblsiK3ArIjEiK2srIl0iK3ArIiBDcmFjayBJRCBGcm9tIFB1YmxpYy9GcmllbmQiKSkKICAgIHByaW50KChrKyJbIitwKyIyIitrKyJdIitwKyIgQ3JhY2sgSUQgRnJvbSBGb2xsb3dlcnMiKSkKICAgIHByaW50KChrKyJbIitwKyIzIitrKyJdIitwKyIgQ3JhY2sgSUQgRnJvbSBQb3N0IExpa2VzIikpCiAgICBwcmludCgoaysiWyIrcCsiNCIraysiXSIrcCsiIENyYWNrIEJ5IFBob25lIE51bWJlciIpKQogICAgcHJpbnQoKGsrIlsiK3ArIjUiK2srIl0iK3ArIiBDcmFjayBCeSBFbWFpbCIpKQogICAgcHJpbnQoKGsrIlsiK3ArIjYiK2srIl0iK3ArIiBHZXQgRGF0YSBUYXJnZXQiKSkKICAgIHByaW50KChrKyJbIitwKyI3IitrKyJdIitwKyIgUmVzdWx0IENyYWNrIikpCiAgICBwcmludCgoaysiWyIrcCsiMCIraysiXSIrcCsiIExvZ291dCIpKQogICAgY2hvb3NlX21lbnUoKQoKZGVmIGNob29zZV9tZW51KCk6CglyPWlucHV0KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ2hvb3NlIDogIikKCWlmIHI9PSIiOgoJCXByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKQoJCW1lbnUoKQoJZWxpZiByPT0iMSI6CgkJcHVibGlrKCkKCWVsaWYgcj09IjIiOgoJCWZvbGxvdygpCgllbGlmIHI9PSIzIjoKCQlsaWtlcnMoKQoJZWxpZiByPT0iNCI6CgkJcmFuZG9tX251bWJlcnMoKQoJZWxpZiByPT0iNSI6CgkJcmFuZG9tX2VtYWlsKCkKCWVsaWYgcj09IjYiOgoJCXRhcmdldCgpCgllbGlmIHI9PSI3IjoKCQlyZXNzKCkKCWVsaWYgcj09IjAiOgoJCXRyeToKCQkJamFsYW4oaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBUaGFua3MgRm9yIFVzaW5nIE15IFNjcmlwdCIpCgkJCW9zLnN5c3RlbSgicm0gLXJmIGxvZ2luLnR4dCIpCgkJCWV4aXQoKQoJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJcHJpbnQoKGsrIlsiK3ArIiEiK2srIl0iK3ArIiBFcnJvciAlcyIlZSkpCgllbHNlOgoJCXByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgV3JvbmcgSW5wdXQiKSkKCQltZW51KCkJCgpkZWYgcGlsaWhjcmFjayhmaWxlKToKICBwcmludCgoaysiXG5bIitwKyIxIitrKyJdIitwKyIgTWJhc2ljICgiK2grIlJlY29tbWVuZGVkIitwKyIpIikpCiAgcHJpbnQoKGsrIlsiK3ArIjIiK2srIl0iK3ArIiBNYmFzaWMgKyBUVEwiKSkKICBrcmFoPWlucHV0KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ2hvb3NlIDogIikKICBpZiBrcmFoIGluWyIiXToKICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKQogICAgcGlsaWhjcmFjayhmaWxlKQogIGVsaWYga3JhaCBpblsiMSIsIjAxIl06CiAgICBjcmFjayhmaWxlKQogIGVsaWYga3JhaCBpblsiMiIsIjAyIl06CiAgICBjcmFja3R0bChmaWxlKQogIGVsc2U6CiAgICBwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiIEZpbGwgSW4gVGhlIENvcnJlY3QiKSkKICAgIHBpbGloY3JhY2soZmlsZSkKCiMjIyBEVU1QIElEICMjIwoKZGVmIHB1YmxpaygpOgoJdHJ5OgoJCXRva2V0PW9wZW4oImxvZ2luLnR4dCIsInIiKS5yZWFkKCkKCWV4Y2VwdCBJT0Vycm9yOgoJCXByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBDb29raWUvVG9rZW4gSW52YWxpZCIpKQoJCW9zLnN5c3RlbSgicm0gLXJmIGxvZ2luLnR4dCIpCgkJbG9ncygpCgl0cnk6CgkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgVHlwZSBcJ21lXCcgVG8gRHVtcCBGcm9tIEZyaWVuZGxpc3QiKSkKCQlpZHQgPSBpbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBVc2VyIElEIFRhcmdldCA6ICIpCgkJdHJ5OgoJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCW9wID0ganNvbi5sb2Fkcyhqb2sudGV4dCkKCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIE5hbWUgOiAiK29wWyJuYW1lIl0pKQoJCWV4Y2VwdCBLZXlFcnJvcjoKCQkJcHJpbnQoKGsrIlsiK3ArIiEiK2srIl0iK3ArIiBJRCBOb3QgRm91bmQiKSkKCQkJcHJpbnQoKGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKSkKCQkJcHVibGlrKCkKCQlyPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIi9mcmllbmRzP2xpbWl0PTEwMDAwJmFjY2Vzc190b2tlbj0iK3Rva2V0KQoJCWlkID0gW10KCQl6PWpzb24ubG9hZHMoci50ZXh0KQoJCXFxID0gKG9wWyJmaXJzdF9uYW1lIl0rIi5qc29uIikucmVwbGFjZSgiICIsIl8iKQoJCXlzID0gb3BlbihxcSAsICJ3IikjLnJlcGxhY2UoIiAiLCJfIikKCQlmb3IgYSBpbiB6WyJkYXRhIl06CgkJCWlkLmFwcGVuZChhWyJpZCJdKyI8PT4iK2FbIm5hbWUiXSkKCQkJeXMud3JpdGUoYVsiaWQiXSsiPD0+IithWyJuYW1lIl0rIlxuIikKCQl5cy5jbG9zZSgpCgkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFRvdGFsIElEIDogJXMiJShsZW4oaWQpKSkpCgkJcmV0dXJuIHBpbGloY3JhY2socXEpCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJZXhpdChrKyJbIitwKyIhIitrKyJdIitwKyIgRXJyb3IgOiAlcyIlZSkKCmRlZiBmb2xsb3coKToKCXRyeToKCQl0b2tldD1vcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpCglleGNlcHQgSU9FcnJvcjoKCQlwcmludCgoaysiXG5bIitwKyIhIitrKyJdIitwKyIgQ29va2llL1Rva2VuIEludmFsaWQiKSkKCQlvcy5zeXN0ZW0oInJtIC1yZiBsb2dpbi50eHQiKQoJCWxvZ3MoKQoJdHJ5OgoJCWlkdCA9IGlucHV0KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgRm9sbG93ZXJzIElEIFRhcmdldCA6ICIpCgkJdHJ5OgoJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCW9wID0ganNvbi5sb2Fkcyhqb2sudGV4dCkKCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIE5hbWUgOiAiK29wWyJuYW1lIl0pKQoJCWV4Y2VwdCBLZXlFcnJvcjoKCQkJcHJpbnQoKGsrIlsiK3ArIiEiK2srIl0iK3ArIiBJRCBOb3QgRm91bmQiKSkKCQkJcHJpbnQoKGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKSkKCQkJcHVibGlrKCkKCQlyPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIi9zdWJzY3JpYmVycz9saW1pdD0yMDAwMCZhY2Nlc3NfdG9rZW49Iit0b2tldCkKCQlpZCA9IFtdCgkJej1qc29uLmxvYWRzKHIudGV4dCkKCQlxcSA9IChvcFsiZmlyc3RfbmFtZSJdKyIuanNvbiIpLnJlcGxhY2UoIiAiLCJfIikKCQl5cyA9IG9wZW4ocXEgLCAidyIpIy5yZXBsYWNlKCIgIiwiXyIpCgkJZm9yIGEgaW4gelsiZGF0YSJdOgoJCQlpZC5hcHBlbmQoYVsiaWQiXSsiPD0+IithWyJuYW1lIl0pCgkJCXlzLndyaXRlKGFbImlkIl0rIjw9PiIrYVsibmFtZSJdKyJcbiIpCgkJeXMuY2xvc2UoKQoJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBJRCA6ICVzIiUobGVuKGlkKSkpKQoJCXJldHVybiBwaWxpaGNyYWNrKHFxKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWV4aXQoaysiWyIrcCsiISIraysiXSIrcCsiIEVycm9yIDogJXMiJWUpCgpkZWYgbGlrZXJzKCk6Cgl0cnk6CgkJdG9rZXQ9b3BlbigibG9naW4udHh0IiwiciIpLnJlYWQoKQoJZXhjZXB0IElPRXJyb3I6CgkJcHJpbnQoKGsrIlxuWyIrcCsiISIraysiXSIrcCsiIENvb2tpZS9Ub2tlbiBJbnZhbGlkIikpCgkJb3Muc3lzdGVtKCJybSAtcmYgbG9naW4udHh0IikKCQlsb2dzKCkKCXRyeToKCQlpZHQgPSBpbnB1dChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIElEIFBvc3QgVGFyZ2V0IDogIikKCQl0cnk6CgkJCWpvayA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIj9hY2Nlc3NfdG9rZW49Iit0b2tldCkKCQkJb3AgPSBqc29uLmxvYWRzKGpvay50ZXh0KQoJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgTmFtZSA6ICIrb3BbIm5hbWUiXSkpCgkJZXhjZXB0IEtleUVycm9yOgoJCQlwcmludCgoaysiWyIrcCsiISIraysiXSIrcCsiIElEIE5vdCBGb3VuZCIpKQoJCQlwcmludCgoaysiXG5bICIrcCsiQmFjayIraysiIF0iK3ApKQoJCQlwdWJsaWsoKQoJCXI9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiL2xpa2VzP2xpbWl0PTEwMDAwMCZhY2Nlc3NfdG9rZW49Iit0b2tldCkKCQlpZCA9IFtdCgkJej1qc29uLmxvYWRzKHIudGV4dCkKCQlxcSA9IChvcFsiZmlyc3RfbmFtZSJdKyIuanNvbiIpLnJlcGxhY2UoIiAiLCJfIikKCQl5cyA9IG9wZW4ocXEgLCAidyIpIy5yZXBsYWNlKCIgIiwiXyIpCgkJZm9yIGEgaW4gelsiZGF0YSJdOgoJCQlpZC5hcHBlbmQoYVsiaWQiXSsiPD0+IithWyJuYW1lIl0pCgkJCXlzLndyaXRlKGFbImlkIl0rIjw9PiIrYVsibmFtZSJdKyJcbiIpCgkJeXMuY2xvc2UoKQoJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBJRCA6ICVzIiUobGVuKGlkKSkpKQoJCXJldHVybiBwaWxpaGNyYWNrKHFxKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWV4aXQoaysiWyIrcCsiISIraysiXSIrcCsiIEVycm9yIDogJXMiJWUpCgojIyMgQ1JBQ0sgRU1BSUwgJiBQSE9ORSAjIyMKCmRlZiByYW5kb21fbnVtYmVycygpOgogIGRhdGEgPSBbXQogIHByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIE51bWJlciBNdXN0IEJlIDUgRGlnaXQiKSkKICBwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRXhhbXBsZSA6IDkyMDM3IikpCiAga29kZT1zdHIoaW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgSW5wdXQgTnVtYmVyIDogIikpCiAgZXhpdCgoaysiXG5bIitwKyIhIitrKyJdIitwKyIgTnVtYmVyIE11c3QgQmUgNSBEaWdpdCIpKSBpZiBsZW4oa29kZSkgPCA1IGVsc2UgJycKICBleGl0KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBOdW1iZXIgTXVzdCBCZSA1IERpZ2l0IikpIGlmIGxlbihrb2RlKSA+IDUgZWxzZSAnJwogIGptbD1pbnQoaW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQW1vdW50IDogIikpCiAgW2RhdGEuYXBwZW5kKHsndXNlcic6IHN0cihlKSwgJ3B3Jzpbc3RyKGVbNTpdKSwgc3RyKGVbNjpdKV19KSBmb3IgZSBpbiBbc3RyKGtvZGUpKycnLmpvaW4oWyclcyclKHJhbmRpbnQoMCw5KSkgZm9yIGkgaW4gcmFuZ2UoMCw3KV0pIGZvciBlIGluIHJhbmdlKGptbCldXQogIHByaW50KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgU3RhcnRlZCwgUGxlYXNlIFdhaXQuLi5cbiIpCiAgd2l0aCBjb25jdXJyZW50LmZ1dHVyZXMuVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTE1KSBhcyB0aDoKICAgIHt0aC5zdWJtaXQoYnJ1dGUsIHVzZXJbJ3VzZXInXSwgdXNlclsncHcnXSk6IHVzZXIgZm9yIHVzZXIgaW4gZGF0YX0KICBpbnB1dChrKyJcblsgIitwKyJCYWNrIitrKyIgXSIrcCkKICBtZW51KCkKCmRlZiByYW5kb21fZW1haWwoKToKICBkYXRhID0gW10KICBuYW1hPWlucHV0KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgVGFyZ2V0IE5hbWUgOiAiKQogIGRvbWFpbj1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBDaG9vc2UgRG9tYWluIFtHXW1haWwsIFtZXWFob28sIFtIXW90bWFpbCA6ICIpLmxvd2VyKCkuc3RyaXAoKQogIGxpc3Q9ewogICAgJ2cnOidAZ21haWwuY29tJywKICAgICd5JzonQHlhaG9vLmNvbScsCiAgICAnaCc6J0Bob3RtYWlsLmNvbScKICB9CiAgZXhpdCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRmlsbCBJbiBUaGUgQ29ycmVjdCIpKSBpZiBub3QgZG9tYWluIGluIFsnZycsJ3knLCdoJ10gZWxzZSAnJwogIGptbD1pbnQoaW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgQW1vdW50IDogIikpCiAgc2V0cHc9aW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgU2V0IFBhc3N3b3JkIDogIikuc3BsaXQoJywnKQogIHByaW50KGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgU3RhcnRlZCwgUGxlYXNlIFdhaXQuLi5cbiIpCiAgW2RhdGEuYXBwZW5kKHsndXNlcic6IG5hbWErc3RyKGUpK2xpc3RbZG9tYWluXSwgJ3B3JzpbKGkpIGZvciBpIGluIHNldHB3XX0pIGZvciBlIGluIHJhbmdlKDEsam1sKzEpXQogIHdpdGggY29uY3VycmVudC5mdXR1cmVzLlRocmVhZFBvb2xFeGVjdXRvcihtYXhfd29ya2Vycz0xNSkgYXMgdGg6CiAgICB7dGguc3VibWl0KGJydXRlLCB1c2VyWyd1c2VyJ10sIHVzZXJbJ3B3J10pOiB1c2VyIGZvciB1c2VyIGluIGRhdGF9CiAgaW5wdXQoaysiXG5bICIrcCsiQmFjayIraysiIF0iK3ApCiAgbWVudSgpCgpkZWYgYnJ1dGUodXNlciwgcGFzc3MpOgogIHRyeToKICAgIGZvciBwdyBpbiBwYXNzczoKICAgICAgcGFyYW1zPXsKICAgICAgICAnYWNjZXNzX3Rva2VuJzogJzM1MDY4NTUzMTcyOCU3QzYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyJywKICAgICAgICAnZm9ybWF0JzogJ0pTT04nLAogICAgICAgICdzZGtfdmVyc2lvbic6ICcyJywKICAgICAgICAnZW1haWwnOiB1c2VyLAogICAgICAgICdsb2NhbGUnOiAnZW5fVVMnLAogICAgICAgICdwYXNzd29yZCc6IHB3LAogICAgICAgICdzZGsnOiAnaW9zJywKICAgICAgICAnZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzJzogJzEnLAogICAgICAgICdzaWcnOiAnM2Y1NTVmOTlmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZjYnLAogICAgICB9CiAgICAgIGFwaT0naHR0cHM6Ly9iLWFwaS5mYWNlYm9vay5jb20vbWV0aG9kL2F1dGgubG9naW4nCiAgICAgIHJlc3BvbnNlPXJlcXVlc3RzLmdldChhcGksIHBhcmFtcz1wYXJhbXMpCiAgICAgIGlmIHJlLnNlYXJjaCgnKEVBQUEpXHcrJywgc3RyKHJlc3BvbnNlLnRleHQpKToKICAgICAgICBwcmludCgnXHgxYlswOzMybVtceDFiWzA7MzdtS2FjaGktT0tceDFiWzA7MzJtXSAlcyDigKIgJXMgJyUoc3RyKHVzZXIpLCBzdHIocHcpKSkKICAgICAgICBicmVhawogICAgICBlbGlmICd3d3cuZmFjZWJvb2suY29tJyBpbiByZXNwb25zZS5qc29uKClbJ2Vycm9yX21zZyddOgogICAgICAgIHByaW50KCdceDFiWzA7MzNtW1x4MWJbMDszN21LYWNoaS1DUFx4MWJbMDszM21dICVzIOKAoiAlcyAnJShzdHIodXNlciksIHN0cihwdykpKQogICAgICAgIGJyZWFrCiAgZXhjZXB0OiBwYXNzCgojIyMgSU5GTyBBQ0NPVU5UICMjIwoKZGVmIHRhcmdldCgpOgoJdHJ5OgoJCXRva2V0PW9wZW4oImxvZ2luLnR4dCIsInIiKS5yZWFkKCkKCWV4Y2VwdCBJT0Vycm9yOgoJCXByaW50KChrKyJcblsiK3ArIiEiK2srIl0iK3ArIiBUb2tlbiBJbnZhbGlkIikpCgkJb3Muc3lzdGVtKCJybSAtcmYgbG9naW4udHh0IikKCQlsb2dpbigpCgl0cnk6CgkJaWR0ID0gaW5wdXQoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBJRCBUYXJnZXQgICAgICAgIDogIikKCQl0cnk6CgkJCWpvayA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIj9hY2Nlc3NfdG9rZW49Iit0b2tldCkKCQkJb3AgPSBqc29uLmxvYWRzKGpvay50ZXh0KQoJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgTmFtZSBBY2NvdW50ICAgICA6ICIrb3BbIm5hbWUiXSkpCgkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBVc2VybmFtZSAgICAgICAgIDogIitvcFsidXNlcm5hbWUiXSkpCgkJCXRyeToKCQkJCWpvayA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitpZHQrIj9hY2Nlc3NfdG9rZW49Iit0b2tldCkKCQkJCW9wID0ganNvbi5sb2Fkcyhqb2sudGV4dCkKCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBFbWFpbCAgICAgICAgICAgIDogIitvcFsiZW1haWwiXSkpCgkJCWV4Y2VwdCBLZXlFcnJvcjoKCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBFbWFpbCAgICAgICAgICAgIDogLSIpKQoJCQl0cnk6CgkJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCQlvcCA9IGpzb24ubG9hZHMoam9rLnRleHQpCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRGF0ZSBPZiBCaXJ0aCAgICA6ICIrb3BbImJpcnRoZGF5Il0pKQoJCQlleGNlcHQgS2V5RXJyb3I6CgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRGF0ZSBPZiBCaXJ0aCAgICA6IC0iKSkKCQkJdHJ5OgoJCQkJam9rID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiP2FjY2Vzc190b2tlbj0iK3Rva2V0KQoJCQkJb3AgPSBqc29uLmxvYWRzKGpvay50ZXh0KQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIEdlbmRlciAgICAgICAgICAgOiAiK29wWyJnZW5kZXIiXSkpCgkJCWV4Y2VwdCBLZXlFcnJvcjoKCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBHZW5kZXIgICAgICAgICAgIDogLSIpKQoJCQl0cnk6CgkJCQlyID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiL2ZyaWVuZHM/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCQlpZCA9IFtdCgkJCQl6ID0ganNvbi5sb2FkcyhyLnRleHQpCgkJCQlxcSA9IChvcFsiZmlyc3RfbmFtZSJdKyIuanNvbiIpLnJlcGxhY2UoIiAiLCJfIikKCQkJCXlzID0gb3BlbihxcSAsICJ3IikKCQkJCWZvciBpIGluIHpbImRhdGEiXToKCQkJCQlpZC5hcHBlbmQoaVsiaWQiXSkKCQkJCQl5cy53cml0ZShpWyJpZCJdKQoJCQkJeXMuY2xvc2UoKQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFRvdGFsIEZyaWVuZCAgICAgOiAlcyIlKGxlbihpZCkpKSkKCQkJZXhjZXB0IEtleUVycm9yOgoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFRvdGFsIEZyaWVuZCAgICAgOiAtIikpCgkJCXRyeToKCQkJCWE9cmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iK2lkdCsiL3N1YnNjcmliZXJzP2xpbWl0PTIwMDAwJmFjY2Vzc190b2tlbj0iK3Rva2V0KQoJCQkJaWQgPSBbXQoJCQkJYiA9IGpzb24ubG9hZHMoYS50ZXh0KQoJCQkJYmIgPSAob3BbImZpcnN0X25hbWUiXSsiLmpzb24iKS5yZXBsYWNlKCIgIiwiXyIpCgkJCQlqdyA9IG9wZW4oYmIgLCAidyIpCgkJCQlmb3IgYyBpbiBiWyJkYXRhIl06CgkJCQkJaWQuYXBwZW5kKGNbImlkIl0pCgkJCQkJancud3JpdGUoY1siaWQiXSkKCQkJCWp3LmNsb3NlKCkKCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBGb2xsb3dlciAgIDogJXMiJShsZW4oaWQpKSkpCgkJCWV4Y2VwdCBLZXlFcnJvcjoKCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBUb3RhbCBGb2xsb3dlciAgIDogLSIpKQoJCQl0cnk6CgkJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCQlvcCA9IGpzb24ubG9hZHMoam9rLnRleHQpCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgV2Vic2l0ZSAgICAgICAgICA6ICIrb3BbIndlYnNpdGUiXSkpCgkJCWV4Y2VwdCBLZXlFcnJvcjoKCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBXZWJzaXRlICAgICAgICAgIDogLSIpKQoJCQlleGNlcHQgSU9FcnJvcjoKCQkJCXByaW50KChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBXZWJzaXRlICAgICAgICAgIDogLSIpKQoJCQl0cnk6CgkJCQlqb2sgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyIraWR0KyI/YWNjZXNzX3Rva2VuPSIrdG9rZXQpCgkJCQlvcCA9IGpzb24ubG9hZHMoam9rLnRleHQpCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgVXBkYXRlIFRpbWUgICAgICA6ICIrb3BbInVwZGF0ZWRfdGltZSJdKSkKCQkJZXhjZXB0IEtleUVycm9yOgoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFVwZGF0ZSBUaW1lICAgICAgOiAtIikpCgkJCWV4Y2VwdCBJT0Vycm9yOgoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFVwZGF0ZSBUaW1lICAgICAgOiAtIikpCgkJCWlucHV0KGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKQoJCQltZW51KCkKCQlleGNlcHQgS2V5RXJyb3I6CgkJCWlucHV0KGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKQoJCQltZW51KCkKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlleGl0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIEVycm9yIDogJXMiJWUpCgojIyMgUEFTU1dPUkQgIyMjCgpkZWYgZ2VuZXJhdGUodGV4dCk6CglyZXN1bHRzPVtdCglnbG9iYWwgaXBzCglmb3IgaSBpbiB0ZXh0LnNwbGl0KCIgIik6CgkJaWYgbGVuKGkpPDM6CgkJCWNvbnRpbnVlCgkJZWxzZToKCQkJaT1pLmxvd2VyKCkKCQkJaWYgbGVuKGkpPT0zIG9yIGxlbihpKT09NCBvciBsZW4oaSk9PTU6CgkJCQlyZXN1bHRzLmFwcGVuZChpKyIxMjMiKQoJCQkJcmVzdWx0cy5hcHBlbmQoaSsiMTIzNDUiKQoJCQllbHNlOgoJCQkJcmVzdWx0cy5hcHBlbmQoaSsiMTIzIikKCQkJCXJlc3VsdHMuYXBwZW5kKGkrIjEyMzQ1IikKCQkJCXJlc3VsdHMuYXBwZW5kKGkpCgkJCQlpZiAiaW5kb25lc2lhIiBpbiBpcHM6CgkJCQkJcmVzdWx0cy5hcHBlbmQoInNheWFuZyIpCgkJCQkJcmVzdWx0cy5hcHBlbmQoImJpc21pbGxhaCIpCgkJCQkJcmVzdWx0cy5hcHBlbmQoImFuamluZyIpCgkJCQkJcmVzdWx0cy5hcHBlbmQoIjEyMzQ1NiIpCglyZXR1cm4gcmVzdWx0cwoKIyMjIEJSVVRFIENSQUNLICMjIwoKZGVmIG1iYXNpYyhlbSxwYXMsaG9zdHMpOgoJcj1yZXF1ZXN0cy5TZXNzaW9uKCkKCXIuaGVhZGVycy51cGRhdGUoeyJIb3N0IjoibWJhc2ljLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiJtYXgtYWdlPTAiLCJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjoiMSIsInVzZXItYWdlbnQiOiJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgOTsgbW90byBlNiBwbGF5IEJ1aWxkL1BPQTI5LjU1MC0xMzI7IHd2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBDaHJvbWUvODUuMC40MTgzLjEwMSBNb2JpbGUgU2FmYXJpLzUzNy4zNiBbRkJfSUFCL0ZCNEE7RkJBVi8zMDUuMS4wLjQwLjEyMDtdIiwiYWNjZXB0IjoidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsImFjY2VwdC1lbmNvZGluZyI6Imd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiJpZC1JRCxpZDtxPTAuOSxlbi1VUztxPTAuOCxlbjtxPTAuNyJ9KQoJcD1yLmdldCgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIpCgliPWJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwiaHRtbC5wYXJzZXIiKQoJbWV0YT0iIi5qb2luKGJzNC5yZS5maW5kYWxsKCdkdHNnIjpceyJ0b2tlbiI6IiguKj8pIicscC50ZXh0KSkKCWRhdGE9e30KCWZvciBpIGluIGIoImlucHV0Iik6CgkJaWYgaS5nZXQoInZhbHVlIikgaXMgTm9uZToKCQkJaWYgaS5nZXQoIm5hbWUiKT09ImVtYWlsIjoKCQkJCWRhdGEudXBkYXRlKHsiZW1haWwiOmVtfSkKCQkJZWxpZiBpLmdldCgibmFtZSIpPT0icGFzcyI6CgkJCQlkYXRhLnVwZGF0ZSh7InBhc3MiOnBhc30pCgkJCWVsc2U6CgkJCQlkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKToiIn0pCgkJZWxzZToKCQkJZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6aS5nZXQoInZhbHVlIil9KQoJZGF0YS51cGRhdGUoCgkJeyJmYl9kdHNnIjptZXRhLCJtX3Nlc3MiOiIiLCJfX3VzZXIiOiIwIiwKCQkiX19yZXEiOiJkIiwiX19jc3IiOiIiLCJfX2EiOiIiLCJfX2R5biI6IiIsImVuY3Bhc3MiOiIiCgkJfQoJKQoJci5oZWFkZXJzLnVwZGF0ZSh7InJlZmVyZXIiOiJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pCglwbz1yLnBvc3QoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9sb2dpbi9kZXZpY2UtYmFzZWQvbG9naW4vYXN5bmMvP3JlZnNyYz1odHRwcyUzQSUyRiUyRm0uZmFjZWJvb2suY29tJTJGbG9naW4lMkYlM0ZyZWYlM0RkYmwmbHd2PTEwMCIsZGF0YT1kYXRhKS50ZXh0CglpZiAiY191c2VyIiBpbiBsaXN0KHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKSk6CgkJcmV0dXJuIHsic3RhdHVzIjoic3VjY2VzcyIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpyLmNvb2tpZXMuZ2V0X2RpY3QoKX0KCWVsaWYgImNoZWNrcG9pbnQiIGluIGxpc3Qoci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpKToKCQlyZXR1cm4geyJzdGF0dXMiOiJjcCIsImVtYWlsIjplbSwicGFzcyI6cGFzLCJjb29raWVzIjpyLmNvb2tpZXMuZ2V0X2RpY3QoKX0KCWVsc2U6cmV0dXJuIHsic3RhdHVzIjoiZXJyb3IiLCJlbWFpbCI6ZW0sInBhc3MiOnBhc30KCmNsYXNzIGNyYWNrOgoJb3Muc3lzdGVtKCJjbGVhciIpCgliYW5uZXIoKQoJZGVmIF9faW5pdF9fKHNlbGYsaXNpZmlsZSk6CgkJc2VsZi5hZGE9W10KCQlzZWxmLmNwPVtdCgkJc2VsZi5rbz0wCgkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgV2l0aCBQYXNzIERlZmF1bHQvTWFudWFsIFtkL21dIikpCgkJd2hpbGUgVHJ1ZToKCQkJZj1pbnB1dChrKyJbIitwKyLigKIiK2srIl0iK3ArIiBDaG9vc2UgOiAiKQoJCQlpZiBmPT0iIjpjb250aW51ZQoJCQllbGlmIGY9PSJtIjoKCQkJCXRyeToKCQkJCQl3aGlsZSBUcnVlOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmFwaz1pc2lmaWxlCgkJCQkJCQlzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkKCQkJCQkJCWJyZWFrCgkJCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQkJCXByaW50KCgiICAgJXMiJWUpKQoJCQkJCQkJY29udGludWUKCQkJCQlzZWxmLmZsPVtdCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF19KQoJCQkJCQlleGNlcHQ6Y29udGludWUKCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQlwcmludCgoIiAgICVzIiVlKSkKCQkJCQljb250aW51ZQoJCQkJcHJpbnQoKGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIEV4YW1wbGUgOiBzYXlhbmcsYmlzbWlsbGFoLDEyMzQ1NiIpKQoJCQkJc2VsZi5wd2xpc3QoKQoJCQkJYnJlYWsKCQkJZWxpZiBmPT0iZCI6CgkJCQl0cnk6CgkJCQkJd2hpbGUgVHJ1ZToKCQkJCQkJdHJ5OgoJCQkJCQkJc2VsZi5hcGs9aXNpZmlsZQoJCQkJCQkJc2VsZi5mcz1vcGVuKHNlbGYuYXBrKS5yZWFkKCkuc3BsaXRsaW5lcygpCgkJCQkJCQlicmVhawoJCQkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQkJCQlwcmludCgoIiAgICVzIiVlKSkKCQkJCQkJCWNvbnRpbnVlCgkJCQkJc2VsZi5mbD1bXQoJCQkJCWZvciBpIGluIHNlbGYuZnM6CgkJCQkJCXRyeToKCQkJCQkJCXNlbGYuZmwuYXBwZW5kKHsiaWQiOmkuc3BsaXQoIjw9PiIpWzBdLCJwdyI6Z2VuZXJhdGUoaS5zcGxpdCgiPD0+IilbMV0pfSkKCQkJCQkJZXhjZXB0OmNvbnRpbnVlCgkJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQkJcHJpbnQoKCIgICAlcyIlZSkpCgkJCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBTdGFydGVkLi4uIitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW0thY2hpLU9LXSBTYXZlZCB0byA6IEthY2hpLU9LLnR4dCIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtLYWNoaS1DUF0gU2F2ZWQgdG8gOiBLYWNoaS1DUC50eHRcbiIpKQoJCQkJVGhyZWFkUG9vbCgzNSkubWFwKHNlbGYubWFpbixzZWxmLmZsKQoJCQkJb3MucmVtb3ZlKHNlbGYuYXBrKQoJCQkJZXhpdCgpCgkJCQlicmVhawoJZGVmIHB3bGlzdChzZWxmKToKCQlzZWxmLnB3PWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIFBhc3N3b3JkIExpc3QgOiAiKS5zcGxpdCgiLCIpCgkJaWYgbGVuKHNlbGYucHcpID09MDoKCQkJc2VsZi5wd2xpc3QoKQoJCWVsc2U6CgkJCWZvciBpIGluIHNlbGYuZmw6CgkJCQlpLnVwZGF0ZSh7InB3IjpzZWxmLnB3fSkKCQkJcHJpbnQoKGsrIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQ3JhY2sgU3RhcnRlZC4uLiIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtLYWNoaS1PS10gU2F2ZWQgdG8gOiBLYWNoaS1PSy50eHQiK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbS2FjaGktQ1BdIFNhdmVkIHRvIDogS2FjaGktQ1AudHh0XG4iKSkKCQkJVGhyZWFkUG9vbCgzMCkubWFwKHNlbGYubWFpbixzZWxmLmZsKQoJCQlvcy5yZW1vdmUoc2VsZi5hcGspCgkJCWV4aXQoKQoJZGVmIG1haW4oc2VsZixmbCk6CgkJdHJ5OgoJCQlmb3IgaSBpbiBmbC5nZXQoInB3Iik6CgkJCQlsb2c9bWJhc2ljKGZsLmdldCgiaWQiKSwKCQkJCQlpLCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iKQoJCQkJaWYgbG9nLmdldCgic3RhdHVzIik9PSJjcCI6CgkJCQkJcHJpbnQoKCJcclx4MWJbMDszM21bXHgxYlswOzM3bUthY2hpLUNQXHgxYlswOzMzbV0gJXMg4oCiICVzICAgICAgICAgICAgICAgIiUoZmwuZ2V0KCJpZCIpLGkpKSkKCQkJCQlzZWxmLmNwLmFwcGVuZCgiJXMg4oCiICVzIiUoZmwuZ2V0KCJpZCIpLGkpKQoJCQkJCW9wZW4oIkthY2hpLUNQLnR4dCIsImErIikud3JpdGUoCgkJCQkJCSIlcyDigKIgJXNcbiIlKGZsLmdldCgiaWQiKSxpKSkKCQkJCQlicmVhawoJCQkJZWxpZiBsb2cuZ2V0KCJzdGF0dXMiKT09InN1Y2Nlc3MiOgoJCQkJCXByaW50KCgiXHJceDFiWzA7MzJtW1x4MWJbMDszN21LYWNoaS1PS1x4MWJbMDszMm1dICVzIOKAoiAlcyAgICAgICAgICAgICAgICIlKGZsLmdldCgiaWQiKSxpKSkpCgkJCQkJc2VsZi5hZGEuYXBwZW5kKCIlcyDigKIgJXMiJShmbC5nZXQoImlkIiksaSkpCgkJCQkJb3BlbigiS2FjaGktT0sudHh0IiwiYSsiKS53cml0ZSgKCQkJCQkJIiVzIOKAoiAlc1xuIiUoZmwuZ2V0KCJpZCIpLGkpKQoJCQkJCWJyZWFrCgkJCQllbHNlOmNvbnRpbnVlCgkJCQkJCgkJCXNlbGYua28rPTEKCQkJcHJpbnQoIlxyXHgxYlswOzMzbVtceDFiWzA7MzdtQ3JhY2tceDFiWzA7MzNtXVx4MWJbMDszN20gJXMvJXMgXHgxYlswOzMybVtceDFiWzA7MzdtS2FjaGktT0sgOiAlc1x4MWJbMDszMm1dIFx4MWJbMDszM21bXHgxYlswOzM3bUthY2hpLUNQIDogJXNceDFiWzA7MzNtXVx4MWJbMDszN20iJShzZWxmLmtvLGxlbihzZWxmLmZsKSxsZW4oc2VsZi5hZGEpLGxlbihzZWxmLmNwKSksIGVuZD0nICcpO3N5cy5zdGRvdXQuZmx1c2goKQoJCWV4Y2VwdDoKCQkJc2VsZi5tYWluKGZsKQoKY2xhc3MgY3JhY2t0dGw6Cglvcy5zeXN0ZW0oImNsZWFyIikKCWJhbm5lcigpCglkZWYgX19pbml0X18oc2VsZixpc2lmaWxlKToKCQlzZWxmLmFkYT1bXQoJCXNlbGYuY3A9W10KCQlzZWxmLmtvPTAKCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBXaXRoIFBhc3MgRGVmYXVsdC9NYW51YWwgW2QvbV0iKSkKCQl3aGlsZSBUcnVlOgoJCQlmPWlucHV0KGsrIlsiK3ArIuKAoiIraysiXSIrcCsiIENob29zZSA6ICIpCgkJCWlmIGY9PSIiOmNvbnRpbnVlCgkJCWVsaWYgZj09Im0iOgoJCQkJdHJ5OgoJCQkJCXdoaWxlIFRydWU6CgkJCQkJCXRyeToKCQkJCQkJCXNlbGYuYXBrPWlzaWZpbGUKCQkJCQkJCXNlbGYuZnM9b3BlbihzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKQoJCQkJCQkJYnJlYWsKCQkJCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCQkJCQkJcHJpbnQoKCIgICAlcyIlZSkpCgkJCQkJCQljb250aW51ZQoJCQkJCXNlbGYuZmw9W10KCQkJCQlmb3IgaSBpbiBzZWxmLmZzOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmZsLmFwcGVuZCh7ImlkIjppLnNwbGl0KCI8PT4iKVswXX0pCgkJCQkJCWV4Y2VwdDpjb250aW51ZQoJCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCQkJCXByaW50KCgiICAgJXMiJWUpKQoJCQkJCWNvbnRpbnVlCgkJCQlwcmludCgoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgRXhhbXBsZSA6IHNheWFuZyxiaXNtaWxsYWgsMTIzNDU2IikpCgkJCQlzZWxmLnB3bGlzdCgpCgkJCQlicmVhawoJCQllbGlmIGY9PSJkIjoKCQkJCXRyeToKCQkJCQl3aGlsZSBUcnVlOgoJCQkJCQl0cnk6CgkJCQkJCQlzZWxmLmFwaz1pc2lmaWxlCgkJCQkJCQlzZWxmLmZzPW9wZW4oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCkKCQkJCQkJCWJyZWFrCgkJCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQkJCXByaW50KCgiICAgJXMiJWUpKQoJCQkJCQkJY29udGludWUKCQkJCQlzZWxmLmZsPVtdCgkJCQkJZm9yIGkgaW4gc2VsZi5mczoKCQkJCQkJdHJ5OgoJCQkJCQkJc2VsZi5mbC5hcHBlbmQoeyJpZCI6aS5zcGxpdCgiPD0+IilbMF0sInB3IjpnZW5lcmF0ZShpLnNwbGl0KCI8PT4iKVsxXSl9KQoJCQkJCQlleGNlcHQ6Y29udGludWUKCQkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCQlwcmludCgoIiAgICVzIiVlKSkKCQkJCXByaW50KChrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIENyYWNrIFN0YXJ0ZWQuLi4iK2srIlxuWyIrcCsi4oCiIitrKyJdIitwKyIgQWNjb3VudCBbS2FjaGktT0tdIFNhdmVkIHRvIDogS2FjaGktT0sudHh0IitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW0thY2hpLUNQXSBTYXZlZCB0byA6IEthY2hpLUNQLnR4dFxuIikpCgkJCQlUaHJlYWRQb29sKDM1KS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpCgkJCQlvcy5yZW1vdmUoc2VsZi5hcGspCgkJCQlleGl0KCkKCQkJCWJyZWFrCglkZWYgcHdsaXN0KHNlbGYpOgoJCXNlbGYucHc9aW5wdXQoaysiWyIrcCsi4oCiIitrKyJdIitwKyIgUGFzc3dvcmQgTGlzdCA6ICIpLnNwbGl0KCIsIikKCQlpZiBsZW4oc2VsZi5wdykgPT0wOgoJCQlzZWxmLnB3bGlzdCgpCgkJZWxzZToKCQkJZm9yIGkgaW4gc2VsZi5mbDoKCQkJCWkudXBkYXRlKHsicHciOnNlbGYucHd9KQoJCQlwcmludCgoaysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBDcmFjayBTdGFydGVkLi4uIitrKyJcblsiK3ArIuKAoiIraysiXSIrcCsiIEFjY291bnQgW0thY2hpLU9LXSBTYXZlZCB0byA6IEthY2hpLU9LLnR4dCIraysiXG5bIitwKyLigKIiK2srIl0iK3ArIiBBY2NvdW50IFtLYWNoaS1DUF0gU2F2ZWQgdG8gOiBLYWNoaS1DUC50eHRcbiIpKQoJCQlUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5tYWluLHNlbGYuZmwpCgkJCW9zLnJlbW92ZShzZWxmLmFwaykKCQkJZXhpdCgpCglkZWYgbWFpbihzZWxmLGZsKToKCQl0cnk6CgkJCWZvciBpIGluIGZsLmdldCgicHciKToKCQkJCWxvZz1tYmFzaWMoZmwuZ2V0KCJpZCIpLAoJCQkJCWksImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbSIpCgkJCQlpZiBsb2cuZ2V0KCJzdGF0dXMiKT09ImNwIjoKCQkJCQl0cnk6CgkJCQkJCWtlPXJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIitmbC5nZXQoImlkIikrIj9hY2Nlc3NfdG9rZW49IitvcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpKQoJCQkJCQl0dD1qc29uLmxvYWRzKGtlLnRleHQpCgkJCQkJCXR0bD10dFsiYmlydGhkYXkiXQoJCQkJCWV4Y2VwdDpwYXNzCgkJCQkJcHJpbnQoKCJcclx4MWJbMDszM21bXHgxYlswOzM3bUthY2hpLUNQXHgxYlswOzMzbV0gJXMg4oCiICVzIOKAoiAlc1x4MWJbMG0gICAiJShmbC5nZXQoImlkIiksaSxzdHIodHRsKSkpKQoJCQkJCXNlbGYuY3AuYXBwZW5kKCIlcyDigKIgJXMiJShmbC5nZXQoImlkIiksaSkpCgkJCQkJb3BlbigiS2FjaGktQ1AudHh0IiwiYSsiKS53cml0ZSgKCQkJCQkJIiVzIOKAoiAlcyDigKIgJXNcbiIlKGZsLmdldCgiaWQiKSxpLHN0cih0dGwpKSkKCQkJCQlicmVhawoJCQkJZWxpZiBsb2cuZ2V0KCJzdGF0dXMiKT09InN1Y2Nlc3MiOgoJCQkJCXByaW50KCgiXHJceDFiWzA7MzJtW1x4MWJbMDszN21LYWNoaS1PS1x4MWJbMDszMm1dICVzIOKAoiAlcyAgICAgICAgICAgICAgICIlKGZsLmdldCgiaWQiKSxpKSkpCgkJCQkJc2VsZi5hZGEuYXBwZW5kKCIlcyDigKIgJXMiJShmbC5nZXQoImlkIiksaSkpCgkJCQkJaWYgZmwuZ2V0KCJpZCIpIGluIG9wZW4oIkthY2hpLU9LLnR4dCIpLnJlYWQoKToKCQkJCQkJYnJlYWsKCQkJCQllbHNlOgoJCQkJCQlvcGVuKCJLYWNoaS1PSy50eHQiLCJhKyIpLndyaXRlKAoJCQkJCQkiJXMg4oCiICVzXG4iJShmbC5nZXQoImlkIiksaSkpCgkJCQkJYnJlYWsKCQkJCWVsc2U6Y29udGludWUKCQkJCQkKCQkJc2VsZi5rbys9MQoJCQlwcmludCgiXHJceDFiWzA7MzNtW1x4MWJbMDszN21DcmFja1x4MWJbMDszM21dXHgxYlswOzM3bSAlcy8lcyBceDFiWzA7MzJtW1x4MWJbMDszN21LYWNoaS1PSyA6ICVzXHgxYlswOzMybV0gXHgxYlswOzMzbVtceDFiWzA7MzdtS2FjaGktQ1AgOiAlc1x4MWJbMDszM21dXHgxYlswOzM3bSIlKHNlbGYua28sbGVuKHNlbGYuZmwpLGxlbihzZWxmLmFkYSksbGVuKHNlbGYuY3ApKSwgZW5kPScgJyk7c3lzLnN0ZG91dC5mbHVzaCgpCgkJZXhjZXB0OgoJCQlzZWxmLm1haW4oZmwpCgojIyMgUkVTVUxUICMjIwoKZGVmIHJlc3VsdHMoRGFwdW50YSxLcmFoa3JhaCk6CiAgICAgICAgaWYgbGVuKERhcHVudGEpICE9MDoKICAgICAgICAgICAgICAgIHByaW50KCgiW09LXSA6ICIrc3RyKGxlbihEYXB1bnRhKSkpKQogICAgICAgIGlmIGxlbihLcmFoa3JhaCkgIT0wOgogICAgICAgICAgICAgICAgcHJpbnQoKCJbQ1BdIDogIitzdHIobGVuKEtyYWhrcmFoKSkpKQogICAgICAgIGlmIGxlbihEYXB1bnRhKSA9PTAgYW5kIGxlbihLcmFoa3JhaCkgPT0wOgogICAgICAgICAgICAgICAgcHJpbnQoIlxuIikKICAgICAgICAgICAgICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgTm8gUmVzdWx0IEZvdW5kIikpCgpkZWYgcmVzcygpOgogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBiYW5uZXIoKQogICAgcHJpbnQoKGsrIlxuWyAiK3ArIlJlc3VsdCBDcmFjayIraysiIF0iK3ApKQogICAgcHJpbnQoKGsrIlxuWyAiK3ArIk9LIitrKyIgXSIrcCkpCiAgICB0cnk6CiAgICAgICAgb3Muc3lzdGVtKCJjYXQgS2FjaGktT0sudHh0IikKICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIHByaW50KChrKyJbIitwKyIhIitrKyJdIitwKyIgTm8gUmVzdWx0IEZvdW5kIikpCiAgICBwcmludCgoaysiXG5bICIrcCsiQ1AiK2srIiBdIitwKSkKICAgIHRyeToKICAgICAgICBvcy5zeXN0ZW0oImNhdCBLYWNoaS1DUC50eHQiKQogICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgcHJpbnQoKGsrIlsiK3ArIiEiK2srIl0iK3ArIiBObyBSZXN1bHQgRm91bmQiKSkKICAgIGlucHV0KGsrIlxuWyAiK3ArIkJhY2siK2srIiBdIitwKQogICAgbWVudSgpCgppZiBfX25hbWVfXz09Il9fbWFpbl9fIjoKCW9zLnN5c3RlbSgiZ2l0IHB1bGwiKQoJbWVudSgpCg=="))